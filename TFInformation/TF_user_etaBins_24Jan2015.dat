<file>## ##################################################################
##                                                                       ##
##                          Matrix Element                               ##
##                          ==============                               ##
##                                                                       ##
##		    Generate the transfer functions                     ##
##	             -------------------------------                    ##
## 	     			                                        ##
##				                                        ##
##    Author: Annik Olbrechts (VUB)                                      ##
##   			                                                ##
##    Version:     1.0.0                         		        ##
##    Last change: 27/11/14			                        ##
##					                                ##
###########################################################################
###########################################################################
##				                                        ##
##				                                        ##
##    Instructions:			                                ##
##								        ##
##	- This program  creates transfer functions in THETA/PHI/E       ##
##	- Those functions must be defined in f77 standard               ##
##	- In addition to each transfer function(START_TF), you MUST give##
##	   the typical width associated to your function (START_WIDTH)	##
##      - If a transfer functions is not defined here it will by default ##
##          - equals to one for neutrino/neutralino                      ##
##          - a delta functions for the rest                             ##
###########################################################################
##                                                                       ##
##   Syntax/variables:                                                   ## 
##                                                                       ##
##  - a definition for transfer functions should define the variable tf  ##
##    while a definition for the width shoud define the variable width   ## 
##	- You can use all standard f77 functions. (All variables are	##
##		in double precision format). 	                        ##
##	- The experimental event is  defined by the variable pexp(i)    ##
##		i=0->3 (0->E,1->Px,2->Py,3->Pz)	                        ##
##	- The partonic event is defined by the variable p(i)	        ##
##		i=0->3 (0->E,1->Px,2->Py,3->Pz)			        ##
##		sigma can not depend on those variables		        ##
##	- You can use 10 local variables			        ##
##		(double precision):  prov1,prov2,...,prov10	        ##
##	- You can call specific functions on p or pexp:	                ##
##		-pt(p)   : transverse momenta 			        ##
##		-eta(p)  : pseudo-rapidity			        ##
##		-rap(p)  : rapidity					##
##		-theta(p): polar angle				        ##
##		-phi(p)	 : azimuthal angle				##
##	- The whole LHCO information is available.                      ##
##              -run_number,trigger                       		##
##		-eta_init(N),phi_init(N),pt_init(N)                     ##
##              -j_mass(N),ntrk(N),btag(N),had_em(N)     	        ##
##		-dummy1(N),dummy2(N)		                        ##
##	    N is the LHCO tag(first column)	                        ##
##		- current tag is n_lhco  				##
##		- tag for missing ET is met_lhco			##
##				  					##
##	- You can incorporate parameters that will be passed through    ##
##	        the transfert_card.dat. Those ones must have the        ##
##		following syntax: #1,#2,#3,.. You can restart 		##
##		the assignement for each different transfer function	##
##	- In addition to each transfer function(tf_), you MUST give	##
##		the typical width associated to your function (sigma_)	##
##		This is needed for the phase space generator      	##
##									##
###########################################################################
###########################################################################

##**********************************************************************##
##             TF for bjet                                      
##**********************************************************************##
<block name='bjet'>   #name can be anything
  <info> double gaussian with parameter depending on the transverse energy </info>
  <particles> b </particles>
  <width_type> thin </width_type>
  #width type should be thin or large (thin is for energy accurate up to 5-10%)
  <variable name='PHI'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*pt(p)+#3*pt(p)**2+#4*pt(p)**3+#5*pt(p)**4)
        prov2=(#6+#7*dsqrt(pt(p))+#8*pt(p))
        prov3=(#9+#10*pt(p)+#11*pt(p)**2+#12*pt(p)**3+#13*pt(p)**4)
        prov4=(#14+#15*pt(p)+#16*pt(p)**2+#17*pt(p)**3+#18*pt(p)**4)
        prov5=(#19+#20*dsqrt(pt(p))+#21*pt(p))
        prov6=(#22+#23*pt(p)+#24*pt(p)**2+#25*pt(p)**3+#26*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*pt(p)+#29*pt(p)**2+#30*pt(p)**3+#31*pt(p)**4)
        prov2=(#32+#33*dsqrt(pt(p))+#34*pt(p))
        prov3=(#35+#36*pt(p)+#37*pt(p)**2+#38*pt(p)**3+#39*pt(p)**4)
        prov4=(#40+#41*pt(p)+#42*pt(p)**2+#43*pt(p)**3+#44*pt(p)**4)
        prov5=(#45+#46*dsqrt(pt(p))+#47*pt(p))
        prov6=(#48+#49*pt(p)+#50*pt(p)**2+#51*pt(p)**3+#52*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*pt(p)+#55*pt(p)**2+#56*pt(p)**3+#57*pt(p)**4)
        prov2=(#58+#59*dsqrt(pt(p))+#60*pt(p))
        prov3=(#61+#62*pt(p)+#63*pt(p)**2+#64*pt(p)**3+#65*pt(p)**4)
        prov4=(#66+#67*pt(p)+#68*pt(p)**2+#69*pt(p)**3+#70*pt(p)**4)
        prov5=(#71+#72*dsqrt(pt(p))+#73*pt(p))
        prov6=(#74+#75*pt(p)+#76*pt(p)**2+#77*pt(p)**3+#78*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*pt(p)+#81*pt(p)**2+#82*pt(p)**3+#83*pt(p)**4)
        prov2=(#84+#85*dsqrt(pt(p))+#86*pt(p))
        prov3=(#87+#88*pt(p)+#89*pt(p)**2+#90*pt(p)**3+#91*pt(p)**4)
        prov4=(#92+#93*pt(p)+#94*pt(p)**2+#95*pt(p)**3+#96*pt(p)**4)
        prov5=(#97+#98*dsqrt(pt(p))+#99*pt(p))
        prov6=(#100+#101*pt(p)+#102*pt(p)**2+#103*pt(p)**3+#104*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(pt(pexp))+#8*pt(pexp))
        prov5=(#19+#20*dsqrt(pt(pexp))+#21*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(pt(pexp))+#34*pt(pexp))
        prov5=(#45+#46*dsqrt(pt(pexp))+#47*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(pt(pexp))+#60*pt(pexp))
        prov5=(#71+#72*dsqrt(pt(pexp))+#73*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(pt(pexp))+#86*pt(pexp))
        prov5=(#97+#98*dsqrt(pt(pexp))+#99*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
  <variable name='PT'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*pt(p)+#3*pt(p)**2+#4*pt(p)**3+#5*pt(p)**4)
        prov2=(#6+#7*dsqrt(pt(p))+#8*pt(p))
        prov3=(#9+#10*pt(p)+#11*pt(p)**2+#12*pt(p)**3+#13*pt(p)**4)
        prov4=(#14+#15*pt(p)+#16*pt(p)**2+#17*pt(p)**3+#18*pt(p)**4)
        prov5=(#19+#20*dsqrt(pt(p))+#21*pt(p))
        prov6=(#22+#23*pt(p)+#24*pt(p)**2+#25*pt(p)**3+#26*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*pt(p)+#29*pt(p)**2+#30*pt(p)**3+#31*pt(p)**4)
        prov2=(#32+#33*dsqrt(pt(p))+#34*pt(p))
        prov3=(#35+#36*pt(p)+#37*pt(p)**2+#38*pt(p)**3+#39*pt(p)**4)
        prov4=(#40+#41*pt(p)+#42*pt(p)**2+#43*pt(p)**3+#44*pt(p)**4)
        prov5=(#45+#46*dsqrt(pt(p))+#47*pt(p))
        prov6=(#48+#49*pt(p)+#50*pt(p)**2+#51*pt(p)**3+#52*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*pt(p)+#55*pt(p)**2+#56*pt(p)**3+#57*pt(p)**4)
        prov2=(#58+#59*dsqrt(pt(p))+#60*pt(p))
        prov3=(#61+#62*pt(p)+#63*pt(p)**2+#64*pt(p)**3+#65*pt(p)**4)
        prov4=(#66+#67*pt(p)+#68*pt(p)**2+#69*pt(p)**3+#70*pt(p)**4)
        prov5=(#71+#72*dsqrt(pt(p))+#73*pt(p))
        prov6=(#74+#75*pt(p)+#76*pt(p)**2+#77*pt(p)**3+#78*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*pt(p)+#81*pt(p)**2+#82*pt(p)**3+#83*pt(p)**4)
        prov2=(#84+#85*dsqrt(pt(p))+#86*pt(p))
        prov3=(#87+#88*pt(p)+#89*pt(p)**2+#90*pt(p)**3+#91*pt(p)**4)
        prov4=(#92+#93*pt(p)+#94*pt(p)**2+#95*pt(p)**3+#96*pt(p)**4)
        prov5=(#97+#98*dsqrt(pt(p))+#99*pt(p))
        prov6=(#100+#101*pt(p)+#102*pt(p)**2+#103*pt(p)**3+#104*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(pt(pexp))+#8*pt(pexp))
        prov5=(#19+#20*dsqrt(pt(pexp))+#21*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(pt(pexp))+#34*pt(pexp))
        prov5=(#45+#46*dsqrt(pt(pexp))+#47*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(pt(pexp))+#60*pt(pexp))
        prov5=(#71+#72*dsqrt(pt(pexp))+#73*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(pt(pexp))+#86*pt(pexp))
        prov5=(#97+#98*dsqrt(pt(pexp))+#99*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
  <variable name='THETA'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*pt(p)+#3*pt(p)**2+#4*pt(p)**3+#5*pt(p)**4)
        prov2=(#6+#7*dsqrt(pt(p))+#8*pt(p))
        prov3=(#9+#10*pt(p)+#11*pt(p)**2+#12*pt(p)**3+#13*pt(p)**4)
        prov4=(#14+#15*pt(p)+#16*pt(p)**2+#17*pt(p)**3+#18*pt(p)**4)
        prov5=(#19+#20*dsqrt(pt(p))+#21*pt(p))
        prov6=(#22+#23*pt(p)+#24*pt(p)**2+#25*pt(p)**3+#26*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*pt(p)+#29*pt(p)**2+#30*pt(p)**3+#31*pt(p)**4)
        prov2=(#32+#33*dsqrt(pt(p))+#34*pt(p))
        prov3=(#35+#36*pt(p)+#37*pt(p)**2+#38*pt(p)**3+#39*pt(p)**4)
        prov4=(#40+#41*pt(p)+#42*pt(p)**2+#43*pt(p)**3+#44*pt(p)**4)
        prov5=(#45+#46*dsqrt(pt(p))+#47*pt(p))
        prov6=(#48+#49*pt(p)+#50*pt(p)**2+#51*pt(p)**3+#52*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*pt(p)+#55*pt(p)**2+#56*pt(p)**3+#57*pt(p)**4)
        prov2=(#58+#59*dsqrt(pt(p))+#60*pt(p))
        prov3=(#61+#62*pt(p)+#63*pt(p)**2+#64*pt(p)**3+#65*pt(p)**4)
        prov4=(#66+#67*pt(p)+#68*pt(p)**2+#69*pt(p)**3+#70*pt(p)**4)
        prov5=(#71+#72*dsqrt(pt(p))+#73*pt(p))
        prov6=(#74+#75*pt(p)+#76*pt(p)**2+#77*pt(p)**3+#78*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*pt(p)+#81*pt(p)**2+#82*pt(p)**3+#83*pt(p)**4)
        prov2=(#84+#85*dsqrt(pt(p))+#86*pt(p))
        prov3=(#87+#88*pt(p)+#89*pt(p)**2+#90*pt(p)**3+#91*pt(p)**4)
        prov4=(#92+#93*pt(p)+#94*pt(p)**2+#95*pt(p)**3+#96*pt(p)**4)
        prov5=(#97+#98*dsqrt(pt(p))+#99*pt(p))
        prov6=(#100+#101*pt(p)+#102*pt(p)**2+#103*pt(p)**3+#104*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(pt(pexp))+#8*pt(pexp))
        prov5=(#19+#20*dsqrt(pt(pexp))+#21*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(pt(pexp))+#34*pt(pexp))
        prov5=(#45+#46*dsqrt(pt(pexp))+#47*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(pt(pexp))+#60*pt(pexp))
        prov5=(#71+#72*dsqrt(pt(pexp))+#73*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(pt(pexp))+#86*pt(pexp))
        prov5=(#97+#98*dsqrt(pt(pexp))+#99*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
</block>
##**********************************************************************##
##             TF for electron                                      
##**********************************************************************##
<block name='electron'>   #name can be anything
  <info> double gaussian with parameter depending on the transverse energy </info>
  <particles> el </particles>
  <width_type> thin </width_type>
  #width type should be thin or large (thin is for energy accurate up to 5-10%)
  <variable name='PHI'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*pt(p)+#3*pt(p)**2+#4*pt(p)**3+#5*pt(p)**4)
        prov2=(#6+#7*dsqrt(pt(p))+#8*pt(p))
        prov3=(#9+#10*pt(p)+#11*pt(p)**2+#12*pt(p)**3+#13*pt(p)**4)
        prov4=(#14+#15*pt(p)+#16*pt(p)**2+#17*pt(p)**3+#18*pt(p)**4)
        prov5=(#19+#20*dsqrt(pt(p))+#21*pt(p))
        prov6=(#22+#23*pt(p)+#24*pt(p)**2+#25*pt(p)**3+#26*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*pt(p)+#29*pt(p)**2+#30*pt(p)**3+#31*pt(p)**4)
        prov2=(#32+#33*dsqrt(pt(p))+#34*pt(p))
        prov3=(#35+#36*pt(p)+#37*pt(p)**2+#38*pt(p)**3+#39*pt(p)**4)
        prov4=(#40+#41*pt(p)+#42*pt(p)**2+#43*pt(p)**3+#44*pt(p)**4)
        prov5=(#45+#46*dsqrt(pt(p))+#47*pt(p))
        prov6=(#48+#49*pt(p)+#50*pt(p)**2+#51*pt(p)**3+#52*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*pt(p)+#55*pt(p)**2+#56*pt(p)**3+#57*pt(p)**4)
        prov2=(#58+#59*dsqrt(pt(p))+#60*pt(p))
        prov3=(#61+#62*pt(p)+#63*pt(p)**2+#64*pt(p)**3+#65*pt(p)**4)
        prov4=(#66+#67*pt(p)+#68*pt(p)**2+#69*pt(p)**3+#70*pt(p)**4)
        prov5=(#71+#72*dsqrt(pt(p))+#73*pt(p))
        prov6=(#74+#75*pt(p)+#76*pt(p)**2+#77*pt(p)**3+#78*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*pt(p)+#81*pt(p)**2+#82*pt(p)**3+#83*pt(p)**4)
        prov2=(#84+#85*dsqrt(pt(p))+#86*pt(p))
        prov3=(#87+#88*pt(p)+#89*pt(p)**2+#90*pt(p)**3+#91*pt(p)**4)
        prov4=(#92+#93*pt(p)+#94*pt(p)**2+#95*pt(p)**3+#96*pt(p)**4)
        prov5=(#97+#98*dsqrt(pt(p))+#99*pt(p))
        prov6=(#100+#101*pt(p)+#102*pt(p)**2+#103*pt(p)**3+#104*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(pt(pexp))+#8*pt(pexp))
        prov5=(#19+#20*dsqrt(pt(pexp))+#21*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(pt(pexp))+#34*pt(pexp))
        prov5=(#45+#46*dsqrt(pt(pexp))+#47*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(pt(pexp))+#60*pt(pexp))
        prov5=(#71+#72*dsqrt(pt(pexp))+#73*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(pt(pexp))+#86*pt(pexp))
        prov5=(#97+#98*dsqrt(pt(pexp))+#99*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
  <variable name='PT'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*pt(p)+#3*pt(p)**2+#4*pt(p)**3+#5*pt(p)**4)
        prov2=(#6+#7*dsqrt(pt(p))+#8*pt(p))
        prov3=(#9+#10*pt(p)+#11*pt(p)**2+#12*pt(p)**3+#13*pt(p)**4)
        prov4=(#14+#15*pt(p)+#16*pt(p)**2+#17*pt(p)**3+#18*pt(p)**4)
        prov5=(#19+#20*dsqrt(pt(p))+#21*pt(p))
        prov6=(#22+#23*pt(p)+#24*pt(p)**2+#25*pt(p)**3+#26*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*pt(p)+#29*pt(p)**2+#30*pt(p)**3+#31*pt(p)**4)
        prov2=(#32+#33*dsqrt(pt(p))+#34*pt(p))
        prov3=(#35+#36*pt(p)+#37*pt(p)**2+#38*pt(p)**3+#39*pt(p)**4)
        prov4=(#40+#41*pt(p)+#42*pt(p)**2+#43*pt(p)**3+#44*pt(p)**4)
        prov5=(#45+#46*dsqrt(pt(p))+#47*pt(p))
        prov6=(#48+#49*pt(p)+#50*pt(p)**2+#51*pt(p)**3+#52*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*pt(p)+#55*pt(p)**2+#56*pt(p)**3+#57*pt(p)**4)
        prov2=(#58+#59*dsqrt(pt(p))+#60*pt(p))
        prov3=(#61+#62*pt(p)+#63*pt(p)**2+#64*pt(p)**3+#65*pt(p)**4)
        prov4=(#66+#67*pt(p)+#68*pt(p)**2+#69*pt(p)**3+#70*pt(p)**4)
        prov5=(#71+#72*dsqrt(pt(p))+#73*pt(p))
        prov6=(#74+#75*pt(p)+#76*pt(p)**2+#77*pt(p)**3+#78*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*pt(p)+#81*pt(p)**2+#82*pt(p)**3+#83*pt(p)**4)
        prov2=(#84+#85*dsqrt(pt(p))+#86*pt(p))
        prov3=(#87+#88*pt(p)+#89*pt(p)**2+#90*pt(p)**3+#91*pt(p)**4)
        prov4=(#92+#93*pt(p)+#94*pt(p)**2+#95*pt(p)**3+#96*pt(p)**4)
        prov5=(#97+#98*dsqrt(pt(p))+#99*pt(p))
        prov6=(#100+#101*pt(p)+#102*pt(p)**2+#103*pt(p)**3+#104*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(pt(pexp))+#8*pt(pexp))
        prov5=(#19+#20*dsqrt(pt(pexp))+#21*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(pt(pexp))+#34*pt(pexp))
        prov5=(#45+#46*dsqrt(pt(pexp))+#47*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(pt(pexp))+#60*pt(pexp))
        prov5=(#71+#72*dsqrt(pt(pexp))+#73*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(pt(pexp))+#86*pt(pexp))
        prov5=(#97+#98*dsqrt(pt(pexp))+#99*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
  <variable name='THETA'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*pt(p)+#3*pt(p)**2+#4*pt(p)**3+#5*pt(p)**4)
        prov2=(#6+#7*dsqrt(pt(p))+#8*pt(p))
        prov3=(#9+#10*pt(p)+#11*pt(p)**2+#12*pt(p)**3+#13*pt(p)**4)
        prov4=(#14+#15*pt(p)+#16*pt(p)**2+#17*pt(p)**3+#18*pt(p)**4)
        prov5=(#19+#20*dsqrt(pt(p))+#21*pt(p))
        prov6=(#22+#23*pt(p)+#24*pt(p)**2+#25*pt(p)**3+#26*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*pt(p)+#29*pt(p)**2+#30*pt(p)**3+#31*pt(p)**4)
        prov2=(#32+#33*dsqrt(pt(p))+#34*pt(p))
        prov3=(#35+#36*pt(p)+#37*pt(p)**2+#38*pt(p)**3+#39*pt(p)**4)
        prov4=(#40+#41*pt(p)+#42*pt(p)**2+#43*pt(p)**3+#44*pt(p)**4)
        prov5=(#45+#46*dsqrt(pt(p))+#47*pt(p))
        prov6=(#48+#49*pt(p)+#50*pt(p)**2+#51*pt(p)**3+#52*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*pt(p)+#55*pt(p)**2+#56*pt(p)**3+#57*pt(p)**4)
        prov2=(#58+#59*dsqrt(pt(p))+#60*pt(p))
        prov3=(#61+#62*pt(p)+#63*pt(p)**2+#64*pt(p)**3+#65*pt(p)**4)
        prov4=(#66+#67*pt(p)+#68*pt(p)**2+#69*pt(p)**3+#70*pt(p)**4)
        prov5=(#71+#72*dsqrt(pt(p))+#73*pt(p))
        prov6=(#74+#75*pt(p)+#76*pt(p)**2+#77*pt(p)**3+#78*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*pt(p)+#81*pt(p)**2+#82*pt(p)**3+#83*pt(p)**4)
        prov2=(#84+#85*dsqrt(pt(p))+#86*pt(p))
        prov3=(#87+#88*pt(p)+#89*pt(p)**2+#90*pt(p)**3+#91*pt(p)**4)
        prov4=(#92+#93*pt(p)+#94*pt(p)**2+#95*pt(p)**3+#96*pt(p)**4)
        prov5=(#97+#98*dsqrt(pt(p))+#99*pt(p))
        prov6=(#100+#101*pt(p)+#102*pt(p)**2+#103*pt(p)**3+#104*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(pt(pexp))+#8*pt(pexp))
        prov5=(#19+#20*dsqrt(pt(pexp))+#21*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(pt(pexp))+#34*pt(pexp))
        prov5=(#45+#46*dsqrt(pt(pexp))+#47*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(pt(pexp))+#60*pt(pexp))
        prov5=(#71+#72*dsqrt(pt(pexp))+#73*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(pt(pexp))+#86*pt(pexp))
        prov5=(#97+#98*dsqrt(pt(pexp))+#99*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
</block>
##**********************************************************************##
##             TF for nonbjet                                      
##**********************************************************************##
<block name='nonbjet'>   #name can be anything
  <info> double gaussian with parameter depending on the transverse energy </info>
  <particles> u,d,s,c,g </particles>
  <width_type> thin </width_type>
  #width type should be thin or large (thin is for energy accurate up to 5-10%)
  <variable name='PHI'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*pt(p)+#3*pt(p)**2+#4*pt(p)**3+#5*pt(p)**4)
        prov2=(#6+#7*dsqrt(pt(p))+#8*pt(p))
        prov3=(#9+#10*pt(p)+#11*pt(p)**2+#12*pt(p)**3+#13*pt(p)**4)
        prov4=(#14+#15*pt(p)+#16*pt(p)**2+#17*pt(p)**3+#18*pt(p)**4)
        prov5=(#19+#20*dsqrt(pt(p))+#21*pt(p))
        prov6=(#22+#23*pt(p)+#24*pt(p)**2+#25*pt(p)**3+#26*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*pt(p)+#29*pt(p)**2+#30*pt(p)**3+#31*pt(p)**4)
        prov2=(#32+#33*dsqrt(pt(p))+#34*pt(p))
        prov3=(#35+#36*pt(p)+#37*pt(p)**2+#38*pt(p)**3+#39*pt(p)**4)
        prov4=(#40+#41*pt(p)+#42*pt(p)**2+#43*pt(p)**3+#44*pt(p)**4)
        prov5=(#45+#46*dsqrt(pt(p))+#47*pt(p))
        prov6=(#48+#49*pt(p)+#50*pt(p)**2+#51*pt(p)**3+#52*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*pt(p)+#55*pt(p)**2+#56*pt(p)**3+#57*pt(p)**4)
        prov2=(#58+#59*dsqrt(pt(p))+#60*pt(p))
        prov3=(#61+#62*pt(p)+#63*pt(p)**2+#64*pt(p)**3+#65*pt(p)**4)
        prov4=(#66+#67*pt(p)+#68*pt(p)**2+#69*pt(p)**3+#70*pt(p)**4)
        prov5=(#71+#72*dsqrt(pt(p))+#73*pt(p))
        prov6=(#74+#75*pt(p)+#76*pt(p)**2+#77*pt(p)**3+#78*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*pt(p)+#81*pt(p)**2+#82*pt(p)**3+#83*pt(p)**4)
        prov2=(#84+#85*dsqrt(pt(p))+#86*pt(p))
        prov3=(#87+#88*pt(p)+#89*pt(p)**2+#90*pt(p)**3+#91*pt(p)**4)
        prov4=(#92+#93*pt(p)+#94*pt(p)**2+#95*pt(p)**3+#96*pt(p)**4)
        prov5=(#97+#98*dsqrt(pt(p))+#99*pt(p))
        prov6=(#100+#101*pt(p)+#102*pt(p)**2+#103*pt(p)**3+#104*pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(pt(pexp))+#8*pt(pexp))
        prov5=(#19+#20*dsqrt(pt(pexp))+#21*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(pt(pexp))+#34*pt(pexp))
        prov5=(#45+#46*dsqrt(pt(pexp))+#47*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(pt(pexp))+#60*pt(pexp))
        prov5=(#71+#72*dsqrt(pt(pexp))+#73*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(pt(pexp))+#86*pt(pexp))
        prov5=(#97+#98*dsqrt(pt(pexp))+#99*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
  <variable name='PT'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*pt(p)+#3*pt(p)**2+#4*pt(p)**3+#5*pt(p)**4)
        prov2=(#6+#7*dsqrt(pt(p))+#8*pt(p))
        prov3=(#9+#10*pt(p)+#11*pt(p)**2+#12*pt(p)**3+#13*pt(p)**4)
        prov4=(#14+#15*pt(p)+#16*pt(p)**2+#17*pt(p)**3+#18*pt(p)**4)
        prov5=(#19+#20*dsqrt(pt(p))+#21*pt(p))
        prov6=(#22+#23*pt(p)+#24*pt(p)**2+#25*pt(p)**3+#26*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*pt(p)+#29*pt(p)**2+#30*pt(p)**3+#31*pt(p)**4)
        prov2=(#32+#33*dsqrt(pt(p))+#34*pt(p))
        prov3=(#35+#36*pt(p)+#37*pt(p)**2+#38*pt(p)**3+#39*pt(p)**4)
        prov4=(#40+#41*pt(p)+#42*pt(p)**2+#43*pt(p)**3+#44*pt(p)**4)
        prov5=(#45+#46*dsqrt(pt(p))+#47*pt(p))
        prov6=(#48+#49*pt(p)+#50*pt(p)**2+#51*pt(p)**3+#52*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*pt(p)+#55*pt(p)**2+#56*pt(p)**3+#57*pt(p)**4)
        prov2=(#58+#59*dsqrt(pt(p))+#60*pt(p))
        prov3=(#61+#62*pt(p)+#63*pt(p)**2+#64*pt(p)**3+#65*pt(p)**4)
        prov4=(#66+#67*pt(p)+#68*pt(p)**2+#69*pt(p)**3+#70*pt(p)**4)
        prov5=(#71+#72*dsqrt(pt(p))+#73*pt(p))
        prov6=(#74+#75*pt(p)+#76*pt(p)**2+#77*pt(p)**3+#78*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*pt(p)+#81*pt(p)**2+#82*pt(p)**3+#83*pt(p)**4)
        prov2=(#84+#85*dsqrt(pt(p))+#86*pt(p))
        prov3=(#87+#88*pt(p)+#89*pt(p)**2+#90*pt(p)**3+#91*pt(p)**4)
        prov4=(#92+#93*pt(p)+#94*pt(p)**2+#95*pt(p)**3+#96*pt(p)**4)
        prov5=(#97+#98*dsqrt(pt(p))+#99*pt(p))
        prov6=(#100+#101*pt(p)+#102*pt(p)**2+#103*pt(p)**3+#104*pt(p)**4)

        tf=prov3*(exp(-(pt(p)-pt(pexp)-prov1)**2/2d0/prov2**2))            !first gaussian
        tf=tf+prov6*(exp(-(pt(p)-pt(pexp)-prov4)**2/2d0/prov5**2))         !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(pt(pexp))+#8*pt(pexp))
        prov5=(#19+#20*dsqrt(pt(pexp))+#21*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(pt(pexp))+#34*pt(pexp))
        prov5=(#45+#46*dsqrt(pt(pexp))+#47*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(pt(pexp))+#60*pt(pexp))
        prov5=(#71+#72*dsqrt(pt(pexp))+#73*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(pt(pexp))+#86*pt(pexp))
        prov5=(#97+#98*dsqrt(pt(pexp))+#99*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
  <variable name='THETA'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*pt(p)+#3*pt(p)**2+#4*pt(p)**3+#5*pt(p)**4)
        prov2=(#6+#7*dsqrt(pt(p))+#8*pt(p))
        prov3=(#9+#10*pt(p)+#11*pt(p)**2+#12*pt(p)**3+#13*pt(p)**4)
        prov4=(#14+#15*pt(p)+#16*pt(p)**2+#17*pt(p)**3+#18*pt(p)**4)
        prov5=(#19+#20*dsqrt(pt(p))+#21*pt(p))
        prov6=(#22+#23*pt(p)+#24*pt(p)**2+#25*pt(p)**3+#26*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*pt(p)+#29*pt(p)**2+#30*pt(p)**3+#31*pt(p)**4)
        prov2=(#32+#33*dsqrt(pt(p))+#34*pt(p))
        prov3=(#35+#36*pt(p)+#37*pt(p)**2+#38*pt(p)**3+#39*pt(p)**4)
        prov4=(#40+#41*pt(p)+#42*pt(p)**2+#43*pt(p)**3+#44*pt(p)**4)
        prov5=(#45+#46*dsqrt(pt(p))+#47*pt(p))
        prov6=(#48+#49*pt(p)+#50*pt(p)**2+#51*pt(p)**3+#52*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*pt(p)+#55*pt(p)**2+#56*pt(p)**3+#57*pt(p)**4)
        prov2=(#58+#59*dsqrt(pt(p))+#60*pt(p))
        prov3=(#61+#62*pt(p)+#63*pt(p)**2+#64*pt(p)**3+#65*pt(p)**4)
        prov4=(#66+#67*pt(p)+#68*pt(p)**2+#69*pt(p)**3+#70*pt(p)**4)
        prov5=(#71+#72*dsqrt(pt(p))+#73*pt(p))
        prov6=(#74+#75*pt(p)+#76*pt(p)**2+#77*pt(p)**3+#78*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*pt(p)+#81*pt(p)**2+#82*pt(p)**3+#83*pt(p)**4)
        prov2=(#84+#85*dsqrt(pt(p))+#86*pt(p))
        prov3=(#87+#88*pt(p)+#89*pt(p)**2+#90*pt(p)**3+#91*pt(p)**4)
        prov4=(#92+#93*pt(p)+#94*pt(p)**2+#95*pt(p)**3+#96*pt(p)**4)
        prov5=(#97+#98*dsqrt(pt(p))+#99*pt(p))
        prov6=(#100+#101*pt(p)+#102*pt(p)**2+#103*pt(p)**3+#104*pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(pt(pexp))+#8*pt(pexp))
        prov5=(#19+#20*dsqrt(pt(pexp))+#21*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(pt(pexp))+#34*pt(pexp))
        prov5=(#45+#46*dsqrt(pt(pexp))+#47*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(pt(pexp))+#60*pt(pexp))
        prov5=(#71+#72*dsqrt(pt(pexp))+#73*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(pt(pexp))+#86*pt(pexp))
        prov5=(#97+#98*dsqrt(pt(pexp))+#99*pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
</block>
##**********************************************************************##
##             TF for muon                                      
##**********************************************************************##
<block name='muon'>   #name can be anything
  <info> double gaussian with parameter depending on the inverse of transverse energy </info>
  <particles> mu </particles>
  <width_type> thin </width_type>
  #width type should be thin or large (thin is for energy accurate up to 5-10%)
  <variable name='PHI'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*1d0/pt(p)+#3*1d0/pt(p)**2+#4*1d0/pt(p)**3+#5*1d0/pt(p)**4)
        prov2=(#6+#7*dsqrt(1d0/pt(p))+#8*1d0/pt(p))
        prov3=(#9+#10*1d0/pt(p)+#11*1d0/pt(p)**2+#12*1d0/pt(p)**3+#13*1d0/pt(p)**4)
        prov4=(#14+#15*1d0/pt(p)+#16*1d0/pt(p)**2+#17*1d0/pt(p)**3+#18*1d0/pt(p)**4)
        prov5=(#19+#20*dsqrt(1d0/pt(p))+#21*1d0/pt(p))
        prov6=(#22+#23*1d0/pt(p)+#24*1d0/pt(p)**2+#25*1d0/pt(p)**3+#26*1d0/pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*1d0/pt(p)+#29*1d0/pt(p)**2+#30*1d0/pt(p)**3+#31*1d0/pt(p)**4)
        prov2=(#32+#33*dsqrt(1d0/pt(p))+#34*1d0/pt(p))
        prov3=(#35+#36*1d0/pt(p)+#37*1d0/pt(p)**2+#38*1d0/pt(p)**3+#39*1d0/pt(p)**4)
        prov4=(#40+#41*1d0/pt(p)+#42*1d0/pt(p)**2+#43*1d0/pt(p)**3+#44*1d0/pt(p)**4)
        prov5=(#45+#46*dsqrt(1d0/pt(p))+#47*1d0/pt(p))
        prov6=(#48+#49*1d0/pt(p)+#50*1d0/pt(p)**2+#51*1d0/pt(p)**3+#52*1d0/pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*1d0/pt(p)+#55*1d0/pt(p)**2+#56*1d0/pt(p)**3+#57*1d0/pt(p)**4)
        prov2=(#58+#59*dsqrt(1d0/pt(p))+#60*1d0/pt(p))
        prov3=(#61+#62*1d0/pt(p)+#63*1d0/pt(p)**2+#64*1d0/pt(p)**3+#65*1d0/pt(p)**4)
        prov4=(#66+#67*1d0/pt(p)+#68*1d0/pt(p)**2+#69*1d0/pt(p)**3+#70*1d0/pt(p)**4)
        prov5=(#71+#72*dsqrt(1d0/pt(p))+#73*1d0/pt(p))
        prov6=(#74+#75*1d0/pt(p)+#76*1d0/pt(p)**2+#77*1d0/pt(p)**3+#78*1d0/pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*1d0/pt(p)+#81*1d0/pt(p)**2+#82*1d0/pt(p)**3+#83*1d0/pt(p)**4)
        prov2=(#84+#85*dsqrt(1d0/pt(p))+#86*1d0/pt(p))
        prov3=(#87+#88*1d0/pt(p)+#89*1d0/pt(p)**2+#90*1d0/pt(p)**3+#91*1d0/pt(p)**4)
        prov4=(#92+#93*1d0/pt(p)+#94*1d0/pt(p)**2+#95*1d0/pt(p)**3+#96*1d0/pt(p)**4)
        prov5=(#97+#98*dsqrt(1d0/pt(p))+#99*1d0/pt(p))
        prov6=(#100+#101*1d0/pt(p)+#102*1d0/pt(p)**2+#103*1d0/pt(p)**3+#104*1d0/pt(p)**4)

        tf=prov2*(exp(-(phi(p)-phi(pexp)-prov1)**2/2d0/prov2**2))        !first gaussian
        tf=tf+prov5*(exp(-(phi(p)-phi(pexp)-prov4)**2/2d0/prov5**2))     !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(1d0/pt(pexp))+#8*1d0/pt(pexp))
        prov5=(#19+#20*dsqrt(1d0/pt(pexp))+#21*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(1d0/pt(pexp))+#34*1d0/pt(pexp))
        prov5=(#45+#46*dsqrt(1d0/pt(pexp))+#47*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(1d0/pt(pexp))+#60*1d0/pt(pexp))
        prov5=(#71+#72*dsqrt(1d0/pt(pexp))+#73*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(1d0/pt(pexp))+#86*1d0/pt(pexp))
        prov5=(#97+#98*dsqrt(1d0/pt(pexp))+#99*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
  <variable name='PT'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*1d0/pt(p)+#3*1d0/pt(p)**2+#4*1d0/pt(p)**3+#5*1d0/pt(p)**4)
        prov2=(#6+#7*dsqrt(1d0/pt(p))+#8*1d0/pt(p))
        prov3=(#9+#10*1d0/pt(p)+#11*1d0/pt(p)**2+#12*1d0/pt(p)**3+#13*1d0/pt(p)**4)
        prov4=(#14+#15*1d0/pt(p)+#16*1d0/pt(p)**2+#17*1d0/pt(p)**3+#18*1d0/pt(p)**4)
        prov5=(#19+#20*dsqrt(1d0/pt(p))+#21*1d0/pt(p))
        prov6=(#22+#23*1d0/pt(p)+#24*1d0/pt(p)**2+#25*1d0/pt(p)**3+#26*1d0/pt(p)**4)

        tf=prov2*(exp(-(1d0/pt(p)-1d0/pt(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(1d0/pt(p)-1d0/pt(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*1d0/pt(p)+#29*1d0/pt(p)**2+#30*1d0/pt(p)**3+#31*1d0/pt(p)**4)
        prov2=(#32+#33*dsqrt(1d0/pt(p))+#34*1d0/pt(p))
        prov3=(#35+#36*1d0/pt(p)+#37*1d0/pt(p)**2+#38*1d0/pt(p)**3+#39*1d0/pt(p)**4)
        prov4=(#40+#41*1d0/pt(p)+#42*1d0/pt(p)**2+#43*1d0/pt(p)**3+#44*1d0/pt(p)**4)
        prov5=(#45+#46*dsqrt(1d0/pt(p))+#47*1d0/pt(p))
        prov6=(#48+#49*1d0/pt(p)+#50*1d0/pt(p)**2+#51*1d0/pt(p)**3+#52*1d0/pt(p)**4)

        tf=prov2*(exp(-(1d0/pt(p)-1d0/pt(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(1d0/pt(p)-1d0/pt(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*1d0/pt(p)+#55*1d0/pt(p)**2+#56*1d0/pt(p)**3+#57*1d0/pt(p)**4)
        prov2=(#58+#59*dsqrt(1d0/pt(p))+#60*1d0/pt(p))
        prov3=(#61+#62*1d0/pt(p)+#63*1d0/pt(p)**2+#64*1d0/pt(p)**3+#65*1d0/pt(p)**4)
        prov4=(#66+#67*1d0/pt(p)+#68*1d0/pt(p)**2+#69*1d0/pt(p)**3+#70*1d0/pt(p)**4)
        prov5=(#71+#72*dsqrt(1d0/pt(p))+#73*1d0/pt(p))
        prov6=(#74+#75*1d0/pt(p)+#76*1d0/pt(p)**2+#77*1d0/pt(p)**3+#78*1d0/pt(p)**4)

        tf=prov2*(exp(-(1d0/pt(p)-1d0/pt(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(1d0/pt(p)-1d0/pt(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*1d0/pt(p)+#81*1d0/pt(p)**2+#82*1d0/pt(p)**3+#83*1d0/pt(p)**4)
        prov2=(#84+#85*dsqrt(1d0/pt(p))+#86*1d0/pt(p))
        prov3=(#87+#88*1d0/pt(p)+#89*1d0/pt(p)**2+#90*1d0/pt(p)**3+#91*1d0/pt(p)**4)
        prov4=(#92+#93*1d0/pt(p)+#94*1d0/pt(p)**2+#95*1d0/pt(p)**3+#96*1d0/pt(p)**4)
        prov5=(#97+#98*dsqrt(1d0/pt(p))+#99*1d0/pt(p))
        prov6=(#100+#101*1d0/pt(p)+#102*1d0/pt(p)**2+#103*1d0/pt(p)**3+#104*1d0/pt(p)**4)

        tf=prov2*(exp(-(1d0/pt(p)-1d0/pt(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(1d0/pt(p)-1d0/pt(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(1d0/pt(pexp))+#8*1d0/pt(pexp))
        prov5=(#19+#20*dsqrt(1d0/pt(pexp))+#21*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(1d0/pt(pexp))+#34*1d0/pt(pexp))
        prov5=(#45+#46*dsqrt(1d0/pt(pexp))+#47*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(1d0/pt(pexp))+#60*1d0/pt(pexp))
        prov5=(#71+#72*dsqrt(1d0/pt(pexp))+#73*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(1d0/pt(pexp))+#86*1d0/pt(pexp))
        prov5=(#97+#98*dsqrt(1d0/pt(pexp))+#99*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
  <variable name='THETA'>
    <tf>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov1=(#1+#2*1d0/pt(p)+#3*1d0/pt(p)**2+#4*1d0/pt(p)**3+#5*1d0/pt(p)**4)
        prov2=(#6+#7*dsqrt(1d0/pt(p))+#8*1d0/pt(p))
        prov3=(#9+#10*1d0/pt(p)+#11*1d0/pt(p)**2+#12*1d0/pt(p)**3+#13*1d0/pt(p)**4)
        prov4=(#14+#15*1d0/pt(p)+#16*1d0/pt(p)**2+#17*1d0/pt(p)**3+#18*1d0/pt(p)**4)
        prov5=(#19+#20*dsqrt(1d0/pt(p))+#21*1d0/pt(p))
        prov6=(#22+#23*1d0/pt(p)+#24*1d0/pt(p)**2+#25*1d0/pt(p)**3+#26*1d0/pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov1=(#27+#28*1d0/pt(p)+#29*1d0/pt(p)**2+#30*1d0/pt(p)**3+#31*1d0/pt(p)**4)
        prov2=(#32+#33*dsqrt(1d0/pt(p))+#34*1d0/pt(p))
        prov3=(#35+#36*1d0/pt(p)+#37*1d0/pt(p)**2+#38*1d0/pt(p)**3+#39*1d0/pt(p)**4)
        prov4=(#40+#41*1d0/pt(p)+#42*1d0/pt(p)**2+#43*1d0/pt(p)**3+#44*1d0/pt(p)**4)
        prov5=(#45+#46*dsqrt(1d0/pt(p))+#47*1d0/pt(p))
        prov6=(#48+#49*1d0/pt(p)+#50*1d0/pt(p)**2+#51*1d0/pt(p)**3+#52*1d0/pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov1=(#53+#54*1d0/pt(p)+#55*1d0/pt(p)**2+#56*1d0/pt(p)**3+#57*1d0/pt(p)**4)
        prov2=(#58+#59*dsqrt(1d0/pt(p))+#60*1d0/pt(p))
        prov3=(#61+#62*1d0/pt(p)+#63*1d0/pt(p)**2+#64*1d0/pt(p)**3+#65*1d0/pt(p)**4)
        prov4=(#66+#67*1d0/pt(p)+#68*1d0/pt(p)**2+#69*1d0/pt(p)**3+#70*1d0/pt(p)**4)
        prov5=(#71+#72*dsqrt(1d0/pt(p))+#73*1d0/pt(p))
        prov6=(#74+#75*1d0/pt(p)+#76*1d0/pt(p)**2+#77*1d0/pt(p)**3+#78*1d0/pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov1=(#79+#80*1d0/pt(p)+#81*1d0/pt(p)**2+#82*1d0/pt(p)**3+#83*1d0/pt(p)**4)
        prov2=(#84+#85*dsqrt(1d0/pt(p))+#86*1d0/pt(p))
        prov3=(#87+#88*1d0/pt(p)+#89*1d0/pt(p)**2+#90*1d0/pt(p)**3+#91*1d0/pt(p)**4)
        prov4=(#92+#93*1d0/pt(p)+#94*1d0/pt(p)**2+#95*1d0/pt(p)**3+#96*1d0/pt(p)**4)
        prov5=(#97+#98*dsqrt(1d0/pt(p))+#99*1d0/pt(p))
        prov6=(#100+#101*1d0/pt(p)+#102*1d0/pt(p)**2+#103*1d0/pt(p)**3+#104*1d0/pt(p)**4)

        tf=prov2*(exp(-(theta(p)-theta(pexp)-prov1)**2/2d0/prov2**2))    !first gaussian
        tf=tf+prov5*(exp(-(theta(p)-theta(pexp)-prov4)**2/2d0/prov5**2)) !second gaussian
        tf=tf*((1d0/dsqrt(2d0*pi))/(prov2*prov3+prov5*prov6))         !normalisation
      ENDIF 
    </tf> 
    <width>
      IF( ABS(eta(pexp)) .LE. 0.375) THEN 
        prov2=(#6+#7*dsqrt(1d0/pt(pexp))+#8*1d0/pt(pexp))
        prov5=(#19+#20*dsqrt(1d0/pt(pexp))+#21*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.375 .AND. ABS(eta(pexp)) .LE. 0.75) THEN 
        prov2=(#32+#33*dsqrt(1d0/pt(pexp))+#34*1d0/pt(pexp))
        prov5=(#45+#46*dsqrt(1d0/pt(pexp))+#47*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 0.75 .AND. ABS(eta(pexp)) .LE. 1.45) THEN 
        prov2=(#58+#59*dsqrt(1d0/pt(pexp))+#60*1d0/pt(pexp))
        prov5=(#71+#72*dsqrt(1d0/pt(pexp))+#73*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
 
      IF( ABS(eta(pexp)) .GT. 1.45 .AND. ABS(eta(pexp)) .LE. 2.5) THEN 
        prov2=(#84+#85*dsqrt(1d0/pt(pexp))+#86*1d0/pt(pexp))
        prov5=(#97+#98*dsqrt(1d0/pt(pexp))+#99*1d0/pt(pexp))
 
        width = max(prov2, prov5) 
      ENDIF 
    </width> 
  </variable>
</block>
</file>